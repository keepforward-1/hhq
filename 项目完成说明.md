# 基于多源星图识别的天文观测辅助系统 - 项目完成说明

## 项目概述

本项目已完成了一个完整的天文观测辅助系统，包含以下核心功能模块：

1. **星系分类** - 使用AI模型识别和分类星系（目标精度89%）
2. **星座识别** - 通过Roboflow API识别图片中的星座
3. **天体定位** - 使用Astrometry.net精确计算天体坐标
4. **太空引擎** - 高仿真3D宇宙模拟
5. **天巡AI** - 基于DeepSeek API的智能助手，可联动各模块

## 已完成的工作

### 后端（PyCharm 2025.2.4）

✅ **数据库模型**
- 用户模型（User）
- 星系分类记录（GalaxyClassification）
- 星座识别记录（ConstellationRecognition）
- 天体定位记录（CelestialPositioning）
- 太空引擎数据（SpaceEngineData）
- 天巡AI聊天记录（TianxunAIChat）
- 首页内容（HomepageContent）

✅ **API路由**
- 用户认证（注册、登录、获取用户信息）
- 星系分类（上传图片、获取历史）
- 星座识别（上传图片、获取历史）
- 天体定位（上传图片、获取历史）
- 太空引擎（保存视图、获取数据）
- 天巡AI（对话、获取历史、获取会话）
- 首页内容（获取轮播图、更新、科普等）

✅ **服务层**
- 认证服务（密码加密、用户验证）
- 星系分类服务（模型加载、图片预处理、分类预测）
- 星座识别服务（Roboflow API集成）
- 天体定位服务（Astrometry.net API集成）
- 天巡AI服务（DeepSeek API集成、多轮对话、上下文管理）

✅ **模型训练**
- Galaxy10数据集训练脚本
- 深度CNN模型架构
- 数据增强和预处理
- 模型评估和保存（目标精度89%）

✅ **工具函数**
- 文件上传处理
- 图片格式验证

### 前端（Visual Studio Code）

✅ **页面组件**
- 登录页面（Login）
- 注册页面（Register）
- 首页（Home）- 包含轮播图、功能模块导航、天巡AI、平台更新、天文科普
- 星系分类页面（GalaxyClassification）
- 星座识别页面（ConstellationRecognition）
- 天体定位页面（CelestialPositioning）
- 太空引擎页面（SpaceEngine）- 3D宇宙模拟

✅ **通用组件**
- 天巡AI聊天组件（TianxunAI）
- 路由保护组件（ProtectedRoute）

✅ **状态管理**
- 认证上下文（AuthContext）- 用户登录状态、JWT token管理

✅ **样式**
- 响应式布局
- 深色主题（天文风格）
- 模块化CSS

### 数据库（Navicat Premium 16）

✅ **数据库脚本**
- 完整的表结构设计
- 外键关系
- 索引优化
- 示例数据插入

### Astrometry.net部署（CentOS 7.8）

✅ **部署脚本**
- 自动化安装脚本（deploy_astrometry.sh）
- 依赖包安装
- 编译和安装Astrometry.net 0.80
- 索引文件下载

✅ **API服务器**
- Flask API服务器（astrometry_api_server.py）
- 图片上传和解析
- 任务状态查询
- WCS文件解析

## 使用说明

### 1. 环境准备

#### 后端环境
```bash
cd "PyCharm 2025.2.4"
pip install -r requirements.txt
```

#### 前端环境
```bash
cd "Visual Studio Code"
npm install
```

#### 数据库
在Navicat Premium 16中执行 `create_database.sql`

#### Astrometry.net（CentOS 7.8）
```bash
cd "CentOS 7.8"
chmod +x deploy_astrometry.sh
sudo ./deploy_astrometry.sh
```

### 2. 配置环境变量

编辑 `PyCharm 2025.2.4/.env`：
```
DATABASE_URI=mysql+pymysql://root:password@localhost:3306/astronomy_system
SECRET_KEY=your-secret-key
JWT_SECRET_KEY=your-jwt-secret
DEEPSEEK_API_KEY=your-deepseek-api-key
ROBOFLOW_API_KEY=your-roboflow-api-key
ASTROMETRY_API_URL=http://your-centos-server:5000
```

### 3. 训练星系分类模型

1. 下载Galaxy10 DECaLS数据集
   - 访问：https://astronn.readthedocs.io/en/latest/galaxy10.html
   - 下载数据集文件，命名为 `Galaxy10_DECals.h5`
   - 放在项目根目录

2. 运行训练脚本
```bash
cd "PyCharm 2025.2.4"
python train_galaxy_model.py
```

训练完成后，模型会保存在 `models/galaxy_classification_model.h5`

### 4. 启动服务

#### 启动后端
```bash
cd "PyCharm 2025.2.4"
python app.py
```
后端服务运行在 http://localhost:5000

#### 启动Astrometry.net API服务器（CentOS 7.8）
```bash
cd "CentOS 7.8"
python3 astrometry_api_server.py
```
API服务器运行在 http://your-centos-server:5000

#### 启动前端
```bash
cd "Visual Studio Code"
npm run dev
```
前端服务运行在 http://localhost:3000

### 5. 使用系统

1. **注册/登录**
   - 访问 http://localhost:3000
   - 注册新账号或登录

2. **星系分类**
   - 点击"星系分类"模块
   - 上传星系图片
   - 查看分类结果和历史记录

3. **星座识别**
   - 点击"星座识别"模块
   - 上传包含星座的图片
   - 查看识别结果

4. **天体定位**
   - 点击"天体定位"模块
   - 上传天体图片（支持FITS格式）
   - 等待解析完成，查看坐标信息

5. **太空引擎**
   - 点击"太空引擎"模块
   - 使用鼠标交互探索3D宇宙
   - 可以导入其他模块的数据

6. **天巡AI**
   - 在任意页面右侧使用天巡AI
   - 可以提问天文相关问题
   - AI可以联动其他模块，解释结果

## 注意事项

1. **API密钥**
   - 需要申请DeepSeek API密钥：https://platform.deepseek.com/api_keys
   - 需要申请Roboflow API密钥：https://app.roboflow.com

2. **数据集**
   - Galaxy10数据集较大，需要足够的存储空间
   - 模型训练需要GPU支持（推荐），CPU训练时间较长

3. **Astrometry.net**
   - 需要在CentOS 7.8虚拟机上部署
   - 索引文件下载需要网络连接
   - 解析时间取决于图片复杂度和服务器性能

4. **数据库**
   - 确保MySQL服务运行
   - 确保数据库用户有足够权限

5. **Redis（可选）**
   - 如果未配置Redis，部分缓存功能可能不可用
   - 不影响核心功能

## 项目特色

1. **完整的系统架构** - 前后端分离，模块化设计
2. **高精度AI模型** - 星系分类模型目标精度89%
3. **多API集成** - DeepSeek、Roboflow、Astrometry.net
4. **3D可视化** - 基于Three.js的太空引擎
5. **智能助手** - 天巡AI可联动各模块
6. **响应式设计** - 支持多种设备访问

## 技术亮点

- **深度学习** - TensorFlow/Keras模型训练
- **计算机视觉** - 图像分类和目标检测
- **天体测量** - Astrometry.net自动解析
- **3D图形** - Three.js实时渲染
- **RESTful API** - 标准化API设计
- **JWT认证** - 安全的用户认证机制

## 后续优化建议

1. 添加更多数据增强技术提高模型精度
2. 优化Astrometry.net解析速度
3. 增强太空引擎的视觉效果
4. 添加更多天文数据源
5. 实现数据导出功能
6. 添加用户权限管理
7. 实现数据可视化图表

## 项目文件结构

```
基于多源星图识别的天文观测辅助系统的设计与实现/
├── README.md                          # 项目说明
├── 项目完成说明.md                     # 本文档
├── PyCharm 2025.2.4/                  # 后端
│   ├── app.py                         # Flask主应用
│   ├── models/                        # 数据模型
│   ├── routes/                        # API路由
│   ├── services/                      # 业务服务
│   ├── utils/                         # 工具函数
│   ├── train_galaxy_model.py         # 模型训练
│   └── requirements.txt               # 依赖
├── Visual Studio Code/                # 前端
│   ├── src/
│   │   ├── pages/                     # 页面
│   │   ├── components/                # 组件
│   │   └── contexts/                  # 状态管理
│   └── package.json                   # 依赖
├── CentOS 7.8/                        # Astrometry.net
│   ├── deploy_astrometry.sh           # 部署脚本
│   └── astrometry_api_server.py       # API服务器
└── Navicat Premium 16（MySQL）/        # 数据库
    └── create_database.sql            # 数据库脚本
```

## 总结

本项目已完成了一个功能完整、架构清晰的天文观测辅助系统。所有核心模块均已实现，包括AI模型训练、API集成、前端界面等。系统可以直接部署使用，也可以根据需求进一步扩展和优化。

---

**开发完成时间**: 2025年
**项目状态**: ✅ 已完成

